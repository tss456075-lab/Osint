<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>OSINT Masterfile — Malachi Keane (Wakibrine) — Interactive Dossier</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#7c3aed;--muted:#98a0b3;--glass:rgba(255,255,255,0.03)}
    html,body{height:100%;margin:0;font-family:Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial}
    body{background:linear-gradient(180deg,#071129 0%,#071022 50%,#021018 100%);color:#e6eef8}
    header{display:flex;align-items:center;gap:20px;padding:18px 28px;border-bottom:1px solid rgba(255,255,255,0.03)}
    .logo{width:52px;height:52px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#0ea5a9);display:flex;align-items:center;justify-content:center;font-weight:700}
    h1{font-size:18px;margin:0}
    .subtitle{color:var(--muted);font-size:13px}
    main{display:grid;grid-template-columns:360px 1fr 420px;gap:20px;padding:22px}
    .panel{background:var(--card);border-radius:12px;padding:16px;box-shadow:0 6px 20px rgba(2,6,23,0.6)}
    .left .profile{display:flex;gap:12px;align-items:center}
    .avatar{width:84px;height:84px;border-radius:10px;background:var(--glass);display:flex;align-items:center;justify-content:center;font-size:12px;color:var(--muted)}
    .small{font-size:13px;color:var(--muted)}
    .badge{display:inline-block;padding:6px 10px;border-radius:999px;background:rgba(124,58,237,0.12);color:var(--accent);font-weight:600;font-size:12px}
    .link{color:#bfe4ff;text-decoration:none}
    .link:hover{text-decoration:underline}
    .node{padding:8px;margin:8px 0;border-radius:8px;background:rgba(255,255,255,0.02);display:flex;align-items:center;gap:10px}
    .node strong{display:block}
    .center-area{padding:10px}
    #treeCanvas{width:100%;height:640px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));border-radius:10px}
    .right .evidence-list{max-height:320px;overflow:auto}
    .timeline{display:flex;gap:6px;align-items:center;margin-top:10px}
    .timeline .pill{background:rgba(255,255,255,0.02);padding:8px;border-radius:8px}
    .gallery{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-top:10px}
    .gallery img{width:100%;height:110px;object-fit:cover;border-radius:8px;background:#061024}
    footer{padding:12px 22px;color:var(--muted);font-size:12px;border-top:1px solid rgba(255,255,255,0.02);display:flex;justify-content:space-between}
    button{background:var(--accent);color:white;border:0;padding:10px 12px;border-radius:8px;cursor:pointer}
    .controls{display:flex;gap:8px}
    .search{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:inherit}
    .small-muted{font-size:12px;color:var(--muted)}
    .node-detail{margin-top:12px;padding:12px;background:rgba(255,255,255,0.02);border-radius:8px}
    pre{white-space:pre-wrap;word-break:break-word;color:#cfeaff}
    /* responsive */
    @media (max-width:1100px){main{grid-template-columns:1fr;padding:12px} .right{order:3}}
  </style>
</head>
<body>
  <header>
    <div class="logo">OS</div>
    <div>
      <h1>OSINT Masterfile — Malachi Keane ("Wakibrine")</h1>
      <div class="subtitle">Interactive HTML5 dossier: cross-platform footprint, evidence tree, timeline, images, and corroborations</div>
    </div>
    <div style="margin-left:auto;display:flex;gap:10px;align-items:center">
      <div class="small-muted">Generated:</div>
      <div class="small-muted">Snapshot: <strong id="snapshotDate"></strong></div>
      <div class="controls">
        <button id="exportJson">Export JSON</button>
        <button id="downloadHtml">Download HTML</button>
      </div>
    </div>
  </header>

  <main>
    <!-- LEFT: profile + quick links -->
    <div class="panel left">
      <div class="profile">
        <div class="avatar" id="avatar">PHOTO</div>
        <div>
          <div style="display:flex;gap:8px;align-items:center">
            <div style="font-weight:700">Malachi Israel Keane</div>
            <div class="badge">Wakibrine</div>
          </div>
          <div class="small">Public business/contact email: <strong id="email">wakibrine@gmail.com</strong></div>
          <div style="margin-top:8px" class="small-muted">Primary hubs: Twitch · YouTube · Instagram · X · Discord · Linktree</div>
        </div>
      </div>

      <hr style="border:none;border-top:1px solid rgba(255,255,255,0.02);margin:12px 0">

      <div class="small-muted">Quick links</div>
      <div style="margin-top:8px">
        <div class="node"><div style="width:8px;height:8px;background:var(--accent);border-radius:99px"></div><div><strong>Twitch</strong><div class="small">twitch.tv/wakibrine</div></div></div>
        <div class="node"><div style="width:8px;height:8px;background:#06b6d4;border-radius:99px"></div><div><strong>Linktree</strong><div class="small">linktr.ee/wakibrine</div></div></div>
        <div class="node"><div style="width:8px;height:8px;background:#60a5fa;border-radius:99px"></div><div><strong>YouTube</strong><div class="small">youtube.com/@Wakibrine</div></div></div>
        <div class="node"><div style="width:8px;height:8px;background:#f97316;border-radius:99px"></div><div><strong>Instagram</strong><div class="small">@wakibrine</div></div></div>
        <div class="node"><div style="width:8px;height:8px;background:#1d9bf0;border-radius:99px"></div><div><strong>X / Twitter</strong><div class="small">@Wakibrine (bio: Toronto, ON)</div></div></div>
      </div>

      <div style="margin-top:12px">
        <div class="small-muted">Addresses & filings</div>
        <div class="node"><div style="width:8px;height:8px;background:#7dd3fc;border-radius:99px"></div><div><strong>SunBiz — FARUK ENTERPRISE LLC</strong><div class="small">KEANE, MALACHI — 9951 SW 4TH ST, PLANTATION, FL 33324</div></div></div>
        <div class="node"><div style="width:8px;height:8px;background:#34d399;border-radius:99px"></div><div><strong>Property (lead)</strong><div class="small">9951 SW 4th St — owners: Moulton W. Keane & Andrea Keane (public aggregator)</div></div></div>
      </div>

      <div style="margin-top:12px">
        <div class="small-muted">Family / relatives (public leads)</div>
        <div class="node"><div style="width:8px;height:8px;background:#f472b6;border-radius:99px"></div><div><strong>Andrea Keane</strong><div class="small">Listed at same address in public directories (possible relative)</div></div></div>
        <div class="node"><div style="width:8px;height:8px;background:#c084fc;border-radius:99px"></div><div><strong>Moulton W. Keane</strong><div class="small">Owner reference on property history (possible relative)</div></div></div>
      </div>

      <div style="margin-top:14px;display:flex;gap:8px;align-items:center">
        <input class="search" id="searchNode" placeholder="Search nodes, platforms, names..." />
      </div>
    </div>

    <!-- CENTER: interactive tree and timeline -->
    <div class="panel center-area">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div style="font-weight:700">Interactive Web Tree</div>
          <div class="small-muted">Click nodes to expand and inspect details, images, and corroborations</div>
        </div>
        <div class="small-muted">Drag nodes • Export selection</div>
      </div>

      <div id="treeCanvas"></div>

      <div class="node-detail" id="nodeDetail">
        <div style="display:flex;gap:12px;align-items:flex-start">
          <div style="width:88px;height:88px;border-radius:8px;background:#061224;display:flex;align-items:center;justify-content:center;overflow:hidden" id="detailImg">
            <img id="detailImgTag" src="" alt="profile" style="width:100%;height:100%;object-fit:cover;display:none" />
            <div id="detailImgPlaceholder" style="color:var(--muted);padding:8px">Image preview</div>
          </div>
          <div style="flex:1">
            <div style="font-weight:700" id="detailTitle">Select a node</div>
            <div class="small-muted" id="detailSubtitle">Node details will appear here</div>
            <div style="margin-top:8px"><pre id="detailBody" class="small-muted">No node selected</pre></div>
          </div>
        </div>
      </div>

      <div style="margin-top:12px;display:flex;gap:8px;align-items:center;flex-wrap:wrap">
        <div class="timeline">
          <div class="pill"><strong>2020</strong><div class="small-muted">FARUK ENTERPRISE LLC formation (SunBiz)</div></div>
          <div class="pill"><strong>2023</strong><div class="small-muted">FAU commencement listing</div></div>
          <div class="pill"><strong>2023–2025</strong><div class="small-muted">Streaming growth & platform presence</div></div>
        </div>

        <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
          <input id="profileUrls" class="search" placeholder="Paste social profile URLs (comma-separated) e.g. https://twitter.com/Wakibrine, https://instagram.com/wakibrine" />
          <button id="fetchProfiles">Load images from profiles</button>
        </div>
      </div>
    </div>

    <!-- RIGHT: evidence, gallery, raw data -->
    <div class="panel right">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <div style="font-weight:700">Evidence & Raw Links</div>
          <div class="small-muted">Catalog of public URLs and documents</div>
        </div>
      </div>

      <div class="evidence-list" id="evidenceList" style="margin-top:12px">
        <!-- items injected by JS -->
      </div>

      <div style="margin-top:12px">
        <div style="font-weight:700">Image Gallery</div>
        <div class="gallery" id="gallery">
          <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='600' height='400'><rect width='100%' height='100%' fill='%23050b17'/><text x='50%' y='50%' font-size='18' fill='%238ea9c6' text-anchor='middle'>Replace with profile image URL</text></svg>" data-src="" alt="img1"/>
          <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='600' height='400'><rect width='100%' height='100%' fill='%23050b17'/><text x='50%' y='50%' font-size='18' fill='%238ea9c6' text-anchor='middle'>Replace with stream thumbnail URL</text></svg>" data-src="" alt="img2"/>
          <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='600' height='400'><rect width='100%' height='100%' fill='%23050b17'/><text x='50%' y='50%' font-size='18' fill='%238ea9c6' text-anchor='middle'>Replace with property photo URL</text></svg>" data-src="" alt="img3"/>
          <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='600' height='400'><rect width='100%' height='100%' fill='%23050b17'/><text x='50%' y='50%' font-size='18' fill='%238ea9c6' text-anchor='middle'>Replace with document scan URL</text></svg>" data-src="" alt="img4"/>
        </div>
      </div>

      <div style="margin-top:12px">
        <div style="font-weight:700">Raw JSON snapshot</div>
        <pre id="rawJson" style="max-height:220px;overflow:auto;padding:12px;background:rgba(0,0,0,0.15);border-radius:8px;color:#bfe4ff"></pre>
      </div>

      <div style="margin-top:12px">
        <div style="font-weight:700">Notes on dynamic loading</div>
        <div class="small-muted">This dossier attempts to fetch images automatically by retrieving each profile URL and extracting <code>og:image</code> or oEmbed thumbnails. If your browser blocks cross-origin requests, try running from a local webserver (python -m http.server) or use a CORS proxy. The UI will show which fetches succeed and fallbacks. Do not upload private images here.</div>
      </div>
    </div>
  </main>

  <footer>
    <div class="small-muted">Note: This file is a local interactive OSINT dossier. Replace image placeholders with direct image URLs for gallery preview. Use the export button to save JSON.</div>
    <div class="small-muted">Generated by assistant</div>
  </footer>

  <script>
    // Snapshot date
    document.getElementById('snapshotDate').innerText = new Date().toLocaleString();

    // Data model (populate with the findings we have)
    const dossier = {
      subject: {name: 'Malachi Israel Keane', alias: 'Wakibrine', email: 'wakibrine@gmail.com'},
      platforms: [
        {id: 'twitch', label: 'Twitch', url: 'https://twitch.tv/wakibrine', notes: 'Business email listed on channel'},
        {id: 'linktree', label: 'Linktree', url: 'https://linktr.ee/wakibrine', notes: 'Central hub linking platforms and email'},
        {id: 'youtube', label: 'YouTube', url: 'https://youtube.com/@Wakibrine', notes: 'Shorts and live archives'},
        {id: 'instagram', label: 'Instagram', url: 'https://instagram.com/wakibrine', notes: 'Profile shows name Malachi Keane in bio'},
        {id: 'x', label: 'X / Twitter', url: 'https://x.com/Wakibrine', notes: 'Bio lists Toronto, Ontario (location hint)'},
        {id: 'reddit', label: 'Reddit', url: 'https://reddit.com/u/Wakibrine', notes: 'Cross-platform corroboration of handle and email in profile text'},
        {id: 'discord', label: 'Discord (invite)', url: 'https://discord.gg/wakibrine', notes: 'Public invite link to server "777"'}
      ],
      filings: [
        {id:'sunbiz', label: 'SunBiz — FARUK ENTERPRISE LLC', summary: 'Authorized person listed as KEANE, MALACHI; principal address 9951 SW 4TH ST, Plantation, FL 33324', url: 'https://dos.myflorida.com/sunbiz' }
      ],
      addresses: [
        {label: '9951 SW 4th St, Plantation, FL 33324', notes: 'Property aggregator pages show owners Moulton W. Keane & Andrea Keane (public lead)'}
      ],
      academic: [ {label:'FAU Fall 2023 commencement', notes:'Name Malachi Keane appears in public program (graduation list)'} ],
      donation: [{label:'Streamlabs tip page', url:'https://streamlabs.com/wakibrine', notes:'Donation landing — merchant name visible inside checkout popup'}],
      relatives: [ {label:'Andrea Keane', notes:'Listed at same address in public directories (possible relative)'}, {label:'Moulton W. Keane', notes:'Owner listed on property history (possible relative)'} ]
    };

    // render evidence list
    const evidenceEl = document.getElementById('evidenceList');
    function addEvidence(title, href, snippet){
      const div = document.createElement('div'); div.className='node';
      const left = document.createElement('div'); left.style.flex='1';
      const a = document.createElement('a'); a.href = href; a.textContent = title; a.target='_blank'; a.className='link';
      const s = document.createElement('div'); s.className='small-muted'; s.textContent = snippet;
      left.appendChild(a); left.appendChild(s);
      div.appendChild(left);
      evidenceEl.appendChild(div);
    }

    dossier.platforms.forEach(p=> addEvidence(p.label, p.url, p.notes));
    dossier.filings.forEach(f=> addEvidence(f.label, f.url, f.summary));
    dossier.addresses.forEach(a=> addEvidence(a.label, 'https://www.google.com/maps/search/'+encodeURIComponent(a.label), a.notes));
    dossier.donation.forEach(d=> addEvidence(d.label, d.url, d.notes));

    document.getElementById('rawJson').innerText = JSON.stringify(dossier, null, 2);

    // Tree rendering (simple collapsible force-like layout)
    const width = document.getElementById('treeCanvas').clientWidth;
    const height = 640;
    const canvas = document.createElement('canvas'); canvas.width = width; canvas.height = height; canvas.id='osintCanvas';
    document.getElementById('treeCanvas').appendChild(canvas);
    const ctx = canvas.getContext('2d');

    // nodes & links
    let nodes = [{id:'subject', label:dossier.subject.name, x:width/2, y:80, r:28, type:'subject'}];
    dossier.platforms.forEach((p,i)=> nodes.push({id:p.id,label:p.label,x:100+ (i*80)% (width-200),y:220 + Math.floor(i/6)*120,r:18,type:'platform',meta:p}));
    dossier.filings.forEach((f,i)=> nodes.push({id:f.id||'filing'+i,label:f.label,x:width-140,y:160 + i*100,r:18,type:'filing',meta:f}));
    dossier.addresses.forEach((a,i)=> nodes.push({id:'addr'+i,label:'Address',x:80,y:420 + i*90,r:18,type:'address',meta:a}));
    dossier.relatives.forEach((r,i)=> nodes.push({id:'rel'+i,label:r.label,x:width-120,y:420 + i*90,r:18,type:'relative',meta:r}));

    let links = [];
    nodes.forEach(n=>{ if(n.id!=='subject') links.push({source:'subject',target:n.id}); });

    // simple physics
    function tick(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      // draw links
      ctx.strokeStyle='rgba(255,255,255,0.06)'; ctx.lineWidth=1;
      links.forEach(l=>{
        const a = nodes.find(n=>n.id===l.source); const b = nodes.find(n=>n.id===l.target);
        ctx.beginPath(); ctx.moveTo(a.x,a.y); ctx.lineTo(b.x,b.y); ctx.stroke();
      });
      // draw nodes
      nodes.forEach(n=>{
        ctx.beginPath(); ctx.fillStyle = n.type==='subject'? 'rgba(124,58,237,0.95)' : 'rgba(255,255,255,0.03)';
        ctx.strokeStyle='rgba(255,255,255,0.06)';
        ctx.lineWidth=1; ctx.roundRect = function(x,y,w,h,r){this.moveTo(x+r,y);this.arcTo(x+w,y,x+w,y+h,r);this.arcTo(x+w,y+h,x,y+h,r);this.arcTo(x,y+h,x,y,r);this.arcTo(x,y,x+w,y,r);};
        ctx.beginPath(); ctx.arc(n.x,n.y,n.r,0,Math.PI*2); ctx.fill(); ctx.stroke();
        // label
        ctx.fillStyle = n.type==='subject'? '#fff' : '#cfeaff'; ctx.font='12px system-ui'; ctx.textAlign='center'; ctx.fillText(n.label, n.x, n.y+4);
      });
    }

    // basic interactivity: click node to show details
    function findNodeAt(x,y){ return nodes.find(n=> Math.hypot(n.x-x,n.y-y) < n.r ); }
    canvas.addEventListener('click', e=>{
      const rect = canvas.getBoundingClientRect(); const x = e.clientX-rect.left; const y = e.clientY-rect.top;
      const node = findNodeAt(x,y);
      if(node){ showNodeDetail(node); }
    });

    function showNodeDetail(node){
      document.getElementById('detailTitle').innerText = node.label;
      const subtitle = node.type + (node.meta && node.meta.url? ' • '+ (node.meta.url||'') : '');
      document.getElementById('detailSubtitle').innerText = subtitle;
      let body = '';
      if(node.meta){
        body += (node.meta.summary || node.meta.notes || '') + '
';
        if(node.meta.url) body += '
URL: ' + node.meta.url + '
';
      }
      document.getElementById('detailBody').innerText = body || 'No extra details';
      // image load logic: if meta has an image field use it (placeholders exist)
      const imgTag = document.getElementById('detailImgTag'); const imgPlaceholder = document.getElementById('detailImgPlaceholder');
      if(node.meta && node.meta.image){ imgTag.src = node.meta.image; imgTag.style.display='block'; imgPlaceholder.style.display='none'; } else { imgTag.style.display='none'; imgPlaceholder.style.display='block'; }
    }

    // simple drag to reposition nodes
    let drag = null;
    canvas.addEventListener('mousedown', e=>{
      const rect = canvas.getBoundingClientRect(); const x = e.clientX-rect.left; const y = e.clientY-rect.top; const node = findNodeAt(x,y); if(node){ drag = node; }
    });
    window.addEventListener('mousemove', e=>{ if(drag){ const rect = canvas.getBoundingClientRect(); drag.x = e.clientX-rect.left; drag.y = e.clientY-rect.top; tick(); } });
    window.addEventListener('mouseup', ()=>{ drag=null; });

    // initial render & periodic tick
    tick();

    // Export JSON
    document.getElementById('exportJson').addEventListener('click', ()=>{
      const blob = new Blob([JSON.stringify(dossier,null,2)],{type:'application/json'});
      const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download='malachi_dossier.json'; document.body.appendChild(a); a.click(); a.remove();
    });

    // Download standalone HTML: create an anchor with the current HTML serialized
    document.getElementById('downloadHtml').addEventListener('click', ()=>{
      const html = document.documentElement.outerHTML; const blob = new Blob([html],{type:'text/html'}); const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href=url; a.download='Malachi_Keane_OSINT_Dossier.html'; document.body.appendChild(a); a.click(); a.remove();
    });

    // helper: search nodes
    document.getElementById('searchNode').addEventListener('input', e=>{
      const q = e.target.value.toLowerCase(); nodes.forEach(n=>{ n.highlight = q && (n.label.toLowerCase().includes(q) || (n.meta && JSON.stringify(n.meta).toLowerCase().includes(q))); }); tick();
    });

    // DYNAMIC IMAGE LOADING: try multiple strategies to extract profile images
    async function fetchWithCORS(url){
      // try direct fetch first
      try{
        const res = await fetch(url, {mode:'cors'});
        if(!res.ok) throw new Error('Fetch failed');
        return await res.text();
      }catch(e){
        // try public CORS proxy (AllOrigins)
        try{
          const proxy = 'https://api.allorigins.win/raw?url=' + encodeURIComponent(url);
          const res2 = await fetch(proxy);
          if(!res2.ok) throw new Error('Proxy fetch failed');
          return await res2.text();
        }catch(e2){
          console.warn('Both direct and proxy fetch failed for',url,e2);
          return null;
        }
      }
    }

    function extractOgImage(html){
      if(!html) return null;
      try{
        const doc = new DOMParser().parseFromString(html,'text/html');
        const meta = doc.querySelector('meta[property="og:image"], meta[name="og:image"]');
        if(meta) return meta.getAttribute('content');
        // fallback to twitter:image
        const meta2 = doc.querySelector('meta[name="twitter:image"], meta[property="twitter:image"]');
        if(meta2) return meta2.getAttribute('content');
        return null;
      }catch(e){ return null; }
    }

    async function fetchOEmbedImage(profileUrl){
      // Try common oEmbed endpoints
      const providers = [
        {name:'YouTube', endpoint: 'https://www.youtube.com/oembed?url='},
        {name:'Twitter', endpoint: 'https://publish.twitter.com/oembed?url='},
        {name:'Instagram', endpoint: 'https://graph.facebook.com/v8.0/instagram_oembed?url='},
        {name:'Twitch', endpoint: 'https://api.twitch.tv/v5/oembed?url='}
      ];
      for(const p of providers){
        try{
          const u = p.endpoint + encodeURIComponent(profileUrl) + '&format=json';
          const r = await fetch(u);
          if(!r.ok) continue;
          const j = await r.json();
          if(j.thumbnail_url) return j.thumbnail_url;
          // some return HTML containing img
          if(j.html){ const img = extractOgImage(j.html); if(img) return img; }
        }catch(e){ /* ignore */ }
      }
      return null;
    }

    async function fetchProfileImage(profileUrl){
      // normalize: ensure http
      if(!profileUrl) return null;
      try{
        // First try oEmbed endpoints
        const oembed = await fetchOEmbedImage(profileUrl);
        if(oembed) return oembed;
        // Next try fetching the profile page and extract og:image
        const html = await fetchWithCORS(profileUrl);
        const og = extractOgImage(html);
        if(og) return og;
        // last resort: try known patterns (YouTube channel ID thumbnails, Twitch user avatar pattern)
        // Try Twitch avatar pattern
        try{
          if(profileUrl.includes('twitch.tv')){
            const match = profileUrl.match(/twitch\.tv\/(.+)$/i);
            if(match){
              const username = match[1].replace('/','');
              // public API-less approach: attempt twitch profile image via ii.net proxy (may fail)
              return `https://static-cdn.jtvnw.net/jtv_user_pictures/${username}-profile_image-300x300.png`;
            }
          }
        }catch(e){}
        return null;
      }catch(e){ console.warn('fetchProfileImage error',e); return null; }
    }

    async function loadImagesFromProfiles(urls){
      const gallery = document.getElementById('gallery');
      // clear existing
      Array.from(gallery.children).forEach(img=>{ img.dataset.src=''; img.src = img.getAttribute('src'); });
      const urlList = urls.split(',').map(s=>s.trim()).filter(Boolean);
      for(let i=0;i<urlList.length;i++){
        const u = urlList[i];
        const imgUrl = await fetchProfileImage(u);
        const slot = gallery.children[i] || null;
        if(slot && imgUrl){ slot.src = imgUrl; slot.dataset.src = imgUrl; }
        // append additional images if more profiles than slots
        if(!slot && imgUrl){ const img = document.createElement('img'); img.src=imgUrl; img.dataset.src = imgUrl; document.getElementById('gallery').appendChild(img); }
      }
    }

    document.getElementById('fetchProfiles').addEventListener('click', async ()=>{
      const val = document.getElementById('profileUrls').value;
      if(!val){ alert('Paste one or more profile URLs separated by commas (e.g. https://x.com/Wakibrine, https://instagram.com/wakibrine)'); return; }
      document.getElementById('fetchProfiles').disabled = true; document.getElementById('fetchProfiles').textContent='Loading...';
      await loadImagesFromProfiles(val);
      document.getElementById('fetchProfiles').disabled = false; document.getElementById('fetchProfiles').textContent='Load images from profiles';
    });

    // polyfill for arcTo rounded rect drawing (no-op for now)
    // Serialize JSON into rawJSON area
    document.getElementById('rawJson').innerText = JSON.stringify(dossier, null, 2);

    // small guidance: how to replace gallery images by drag/drop or pasting URL
    document.getElementById('gallery').addEventListener('click', e=>{
      const img = e.target.closest('img'); if(!img) return; const url = prompt('Paste direct image URL to replace this placeholder:'); if(url){ img.src = url; img.dataset.src = url; }
    });
  </script>
</body>
</html>
